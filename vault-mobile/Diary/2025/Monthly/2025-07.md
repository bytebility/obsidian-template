---
title: monthly
aliases: [monthly]
tags: []
created: 2025-07-17T20:36:13
updated: 2025-07-17T20:38:59
---

# monthly
使用 OKR 制定月度目标和关键结果，按照 PDCA 循环（日/周/月总结）落地执行

## 月度计划

> 使用**OKR**，定目标和关键结果,注意要符合**SMART**原则，关键结果需包含**可验证的完成标准**（如 " 方案输出 " 需明确交付物形态/通过评审）

1. 工作计划：产品上线/方案输出
2. 输入目标：精读 1 本书输出 3 篇笔记
3. 输出目标：写作 10 篇（知识管理/自媒体工具），整理 n 个领域的笔记
4. 健康管理：运动 n 次，户外 n 次
5. 社交关系：家庭会议 n 次，社交活动 n 次

## 周总结

> 当前月总结文件（2025-03.md）对应的周报，放在 Diary/2025/Weekly 目录，格式为 2025-W13.md，13 是周序号

```dataviewjs
// 获取当前文件名中的年月信息
function getYearAndMonth(dv) {
  const currentFileName = dv.current().file.name;
  const match = currentFileName.match(/(\d{4})-(\d{2})/);
  
  if (match) {
    return {
      year: match[1],
      month: parseInt(match[2])
    };
  } else {
    const now = new Date();
    return {
      year: now.getFullYear().toString(),
      month: now.getMonth() + 1
    };
  }
}

// 筛选指定月份的周总结文件
function getMonthlyWeeklies(dv, year, month) {
  // 获取所有周总结文件
  const weeklyFiles = dv.pages(`"Diary/${year}/Weekly"`)
    .where(p => p.file.name.startsWith(`${year}-W`))
    .array();
  
  const result = [];
  
  for (const file of weeklyFiles) {
    // 从文件名中提取周数
    const weekMatch = file.file.name.match(/W(\d+)/);
    if (!weekMatch) continue;
    
    const weekNum = parseInt(weekMatch[1]);
    
    // 计算该周的日期
    const firstDayOfYear = new Date(parseInt(year), 0, 1);
    const dayOfWeek = firstDayOfYear.getDay();
    const daysToFirstMonday = dayOfWeek === 0 ? 1 : (8 - dayOfWeek + 1);
    
    const firstMonday = new Date(parseInt(year), 0, daysToFirstMonday);
    const weekStartDate = new Date(firstMonday);
    weekStartDate.setDate(firstMonday.getDate() + (weekNum - 1) * 7);
    
    // 检查这一周是否属于当前月份
    if (weekStartDate.getMonth() + 1 === month) {
      // 计算周的结束日期并格式化
      const weekEndDate = new Date(weekStartDate);
      weekEndDate.setDate(weekStartDate.getDate() + 6);
      const dateRange = `${weekStartDate.getMonth() + 1}/${weekStartDate.getDate()} - ${weekEndDate.getMonth() + 1}/${weekEndDate.getDate()}`;
      
      result.push([file.file.link, dateRange]);
    }
  }
  
  return result;
}

// 主执行代码
const { year, month } = getYearAndMonth(dv);
const monthlyWeeklies = getMonthlyWeeklies(dv, year, month);

// 显示结果
if (monthlyWeeklies.length > 0) {
  dv.table(["文件名", "日期范围"], monthlyWeeklies);
} else {
  dv.paragraph(`没有找到 ${year}年${month}月 的周总结文件`);
}
```

## 数据统计

```dataviewjs  
const quickAddChoice  = "月总结-汇总";
// 获取 QuickAdd 插件 API
const quickAdd = app.plugins.plugins["quickadd"];
if (!quickAdd) {
  new Notice("❌ 未检测到 QuickAdd 插件，请先启用它");
}
const btn = dv.el("button", quickAddChoice);
// 创建按钮并绑定点击事件
btn.addEventListener("click", async () => {
  try {
    await quickAdd.api.executeChoice(quickAddChoice);
  } catch (err) {
    new Notice(`❌ 运行失败：${err.message}`);
  }
});
```

### GDD 统计

```chartsview
type: Pie
data:
  - type: "Observe"
    value: 3
  - type: "Good"
    value: 6
  - type: "Difficult"
    value: 6
  - type: "Different"
    value: 6
options:
  angleField: "value"
  colorField: "type"
  radius: 0.5
  label:
    type: "spider"
    content: "{value}条\n{percentage}\n{name}"
  legend:
    layout: "horizontal"
    position: "bottom"
```

> 点击按钮 `月总结-统计` 生成

### 标签统计

```chartsview
type: Bar
data:
  - tag: "#他人"
    count: 4
  - tag: "#挑战"
    count: 4
  - tag: "#改进"
    count: 4
  - tag: "#环境"
    count: 2
  - tag: "#成就"
    count: 2
  - tag: "#喜悦"
    count: 2
  - tag: "#感恩"
    count: 2
  - tag: "#情绪"
    count: 2
  - tag: "#觉察"
    count: 2
options:
  xField: "count"
  yField: "tag"
  seriesField: "tag"
  label: 
    position: "right"
```

> 点击按钮 `月总结-统计` 生成

## 行动复盘

> check: 使用 obsidian 的数据视图，按周汇总目标执行的关键结果

```dataviewjs
// 配置区
const config = {
  srcSectionTitle: "关键成果（KR）",
  sectionDepth: 4, // #### 关键成果（KR）的级别是4
};

// 获取当前文件中推断的年份与月份
function getYearAndMonth() {
  const currentFileName = dv.current().file.name;
  const match = currentFileName.match(/(\d{4})-(\d{2})/);
  if (match) {
    return { year: match[1], month: match[2] };
  } else {
    const now = new Date();
    return {
      year: now.getFullYear().toString(),
      month: (now.getMonth() + 1).toString().padStart(2, "0")
    };
  }
}

// 根据日期计算ISO标准的周数
function getISOWeekNumber(date) {
  const startOfYear = new Date(date.getFullYear(), 0, 1);
  const daysOffset = date.getDay() - startOfYear.getDay();
  const dayOfYear = Math.floor((date - startOfYear) / (24 * 60 * 60 * 1000));
  const adjustedDayOfYear = dayOfYear + ((daysOffset >= 0 ? daysOffset : daysOffset + 7) % 7);
  return Math.ceil(adjustedDayOfYear / 7);
}

// 查找符合条件的 Weekly 文件
function getWeeklyFilesForMonth(year, month) {
  const weeklyFolder = `Diary/${year}/Weekly`;
  const startDate = new Date(year, month - 1, 1);
  const endDate = new Date(year, month, 0); // 这个月的最后一天
  const startWeek = getISOWeekNumber(startDate);
  const endWeek = getISOWeekNumber(endDate);
  const weeklyFiles = [];

  for (let weekNum = startWeek; weekNum <= endWeek; weekNum++) {
    const fileName = `${year}-W${String(weekNum).padStart(2, '0')}`;
    const file = dv.page(`${weeklyFolder}/${fileName}`);
    
    if (file) {
      weeklyFiles.push({
        file: file,
        weekNum: weekNum
      });
    }
  }

  // 按周号排序
  weeklyFiles.sort((a, b) => a.weekNum - b.weekNum);
  return weeklyFiles;
}

// 提取关键成果部分
async function extractKeyResults(file) {
  const content = await dv.io.load(file.file.path);
  const lines = content.split("\n");
  
  let inKRSection = false;
  let krContent = [];
  
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    
    // 检查是否为关键成果章节标题
    if (line.trim().startsWith("#".repeat(config.sectionDepth)) && line.includes(config.srcSectionTitle)) {
      inKRSection = true;
      continue;
    }
    
    // 如果不在关键成果章节，继续下一行
    if (!inKRSection) continue;
    
    // 检查是否遇到下一个同级或更高级的标题，如果是则退出关键成果章节
    if (line.trim().startsWith("#")) {
      const headingLevel = line.trim().indexOf(" ");
      if (headingLevel <= config.sectionDepth) {
        break;
      }
    }
    
    // 添加到关键成果内容
    krContent.push(line);
  }
  
  return krContent.join("\n");
}

// 主函数
async function main() {
  // 获取年月
  const { year, month } = getYearAndMonth(dv);
  console.log(`${year}年${month}月`);
  // 获取相关的周总结文件
  const weeklyFiles = getWeeklyFilesForMonth(year, month);
  console.log(`${weeklyFiles.length}个文件`); 
  // 如果没有找到文件，显示提示信息
  if (weeklyFiles.length === 0) {
    dv.paragraph(`⚠️ 未找到${year}年${month}月的周总结文件`);
    return;
  }
  
  // 显示每个周总结的关键成果
  for (const weekFile of weeklyFiles) {
    const weekNum = weekFile.weekNum;
    const content = await extractKeyResults(weekFile.file);
    
    if (content.trim()) {
      dv.header(3, `第${weekNum}周 KR`);
      dv.paragraph(content);
    }
  }
  
} 
// 执行主函数
main();
```

## 目标复盘

> 根据行动情况，结合月度计划，行动复盘内的 KR 完成情况，手动总结目标完成情况

### 工作成果

### 输入：阅读

### 输出：公众号

## 策略复盘

> 对目标完成情况，按**GDD**复盘做的好的和不好的，可以做哪些改进调整，为下个阅读提供参考
